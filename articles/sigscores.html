<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An introduction to `sigscores` • sigscores</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to `sigscores`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sigscores</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/sigscores.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/alebarberis/sigscores/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>An introduction to `sigscores`</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/alebarberis/sigscores/blob/main/vignettes/sigscores.Rmd" class="external-link"><code>vignettes/sigscores.Rmd</code></a></small>
      <div class="d-none name"><code>sigscores.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>sigscores</strong> is an helpful package providing an easy
way to compute summary scores for gene signatures.</p>
<p>There is one main function <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code>, that can
be used to compute all the available scores. The scores can be selected
via summary score ids (<code>scores</code> argument) or scorers
(<code>scorers</code> argument).</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Firstly, we load <code>sigscores</code> and other needed
packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alebarberis/sigscores" class="external-link">sigscores</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="seed">Seed<a class="anchor" aria-label="anchor" href="#seed"></a>
</h2>
<p>Now we want to set a seed for the random number generation (RNG). In
fact, different R sessions have different seeds created from current
time and process ID by default, and consequently different simulation
results. By fixing a seed we ensure we will be able to reproduce the
results of this vignette. We can specify a seed by calling
<code><a href="https://rdrr.io/r/base/Random.html" class="external-link">?set.seed</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Set a seed for RNG</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span></span>
<span>  <span class="co">#A seed</span></span>
<span>  seed <span class="op">=</span> <span class="fl">5381L</span>,                   <span class="co">#a randomly chosen integer value</span></span>
<span>  <span class="co">#The kind of RNG to use</span></span>
<span>  kind <span class="op">=</span> <span class="st">"Mersenne-Twister"</span>,      <span class="co">#we make explicit the current R default value</span></span>
<span>  <span class="co">#The kind of Normal generation</span></span>
<span>  normal.kind <span class="op">=</span> <span class="st">"Inversion"</span>       <span class="co">#we make explicit the current R default value</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>We create now some simulated data to use. For this vignette, we will
consider a matrix with 100 genes and 10 samples.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#number of samples</span></span>
<span><span class="va">nc</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="co">#number of genes</span></span>
<span><span class="va">nr</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="co">#create matrix</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nr</span><span class="op">*</span><span class="va">nc</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">nr</span>,</span>
<span>  ncol <span class="op">=</span> <span class="va">nc</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"g"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can inspect the data by using the <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">?head</a></code> function,
which returns the first parts of a vector, matrix, table, data frame or
function. Let’s print the first 6 rows of our matrix.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, n <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="co">#&gt;     S1  S2  S3  S4  S5  S6  S7  S8  S9 S10</span></span>
<span><span class="co">#&gt; g1 993 702 660 854 769 859 940 679 946 218</span></span>
<span><span class="co">#&gt; g2 585 620 941 714 994 369 602 506 981 674</span></span>
<span><span class="co">#&gt; g3 175 779 984 834 460 292 445 953 491 673</span></span>
<span><span class="co">#&gt; g4 778 855 293 140  29 601 980  82 161 115</span></span>
<span><span class="co">#&gt; g5 876  32 838  22 803 804 355 663  11 731</span></span>
<span><span class="co">#&gt; g6 835 462 894 560 885  88 442 199 541 725</span></span></code></pre></div>
<p>We can now define our gene signature. For example, we can randomly
select some genes from the matrix. Let’s select 20 genes.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#number of genes in signature</span></span>
<span><span class="va">ng</span> <span class="op">=</span> <span class="fl">20</span></span>
<span></span>
<span><span class="co">#select genes</span></span>
<span><span class="va">signature</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">ng</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="va">signature</span></span>
<span><span class="co">#&gt;  [1] "g12" "g41" "g23" "g59" "g93" "g70" "g51" "g53" "g20" "g72" "g78" "g48"</span></span>
<span><span class="co">#&gt; [13] "g67" "g46" "g36" "g7"  "g13" "g15" "g45" "g33"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-transformation">Data Transformation<a class="anchor" aria-label="anchor" href="#data-transformation"></a>
</h2>
<p>We may want to compute some of the scores on transformed data. Users
can obviously directly provide the data to work on as
<code>x</code>.</p>
<p>However, to facilitate this task, <code>sigscores</code> provides 3
built-in data transformation functions. A list of currently supported
data transformers is available through the
<code><a href="../reference/getAvailableDataTransformers.html">?getAvailableDataTransformers</a></code> function call.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#list transformers</span></span>
<span><span class="va">data.transformers</span> <span class="op">=</span> <span class="fu"><a href="../reference/getAvailableDataTransformers.html">getAvailableDataTransformers</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print in table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data.transformers</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">id</th>
<th align="left">name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">stepFunction</td>
<td align="left">stepFunction</td>
<td align="left">Step Function</td>
</tr>
<tr class="even">
<td align="left">quantile</td>
<td align="left">quantile</td>
<td align="left">Quantile Normalization</td>
</tr>
<tr class="odd">
<td align="left">z</td>
<td align="left">z</td>
<td align="left">Z-Standardisation</td>
</tr>
</tbody>
</table>
<p>We can extract the ids by selecting the <code>id</code> column.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#transformer ids</span></span>
<span><span class="va">data.transformers.ids</span> <span class="op">=</span> <span class="va">data.transformers</span><span class="op">$</span><span class="va">id</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data.transformers.ids</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "stepFunction" "quantile"     "z"</span></span></code></pre></div>
<p>The data transformation function can be obtained through the
<code><a href="../reference/getDataTransformer.html">?getDataTransformer</a></code> function call. For example, let’s
select a step function as data transformer.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#transformer</span></span>
<span><span class="va">data.transformer</span> <span class="op">=</span> <span class="fu"><a href="../reference/getDataTransformer.html">getDataTransformer</a></span><span class="op">(</span>f <span class="op">=</span> <span class="st">'stepFunction'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#function</span></span>
<span><span class="va">data.transformer</span></span>
<span><span class="co">#&gt; function (x, y = c(-1, 0, 1), thr = NULL, method = c("median", </span></span>
<span><span class="co">#&gt;     "mean", "mode", "midrange", "trimean", "iqm", "iqr", "mad"), </span></span>
<span><span class="co">#&gt;     by = c("rows", "cols"), na.rm = TRUE) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     method = match.arg(method)</span></span>
<span><span class="co">#&gt;     by = match.arg(by)</span></span>
<span><span class="co">#&gt;     if (isTRUE(is.vector(x))) {</span></span>
<span><span class="co">#&gt;         out = stepFunctionTranformationForVector(x = x, y = y, </span></span>
<span><span class="co">#&gt;             thr = thr, method = method, na.rm = na.rm)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     else if (isTRUE(is.matrix(x))) {</span></span>
<span><span class="co">#&gt;         out = stepFunctionTranformationForMatrix(x = x, y = y, </span></span>
<span><span class="co">#&gt;             thr = thr, method = method, by = by, na.rm = na.rm)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     else {</span></span>
<span><span class="co">#&gt;         stop("Error: 'x' class is not supported.\n")</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     return(out)</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x556083f93800&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: namespace:sigscores&gt;</span></span></code></pre></div>
<p>Looking at the documentation of <code><a href="../reference/getDataTransformer.html">?getDataTransformer</a></code> we
can see the function for computing the step function is called
<code><a href="../reference/stepFunctionTranformation.html">?stepFunctionTranformation</a></code>, which accepts different
arguments. In particular, <code>method</code> indicates the score to be
used as threshold in the step function, and <code>by</code> indicates
whether to compute the threshold by applying <code>method</code> to rows
or columns of <code>x</code>.</p>
<p>We can then use the transformer to create a new data set to be used
for the computation of the scores.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#transform data</span></span>
<span><span class="va">newx</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>  what <span class="op">=</span> <span class="va">data.transformer</span>, </span>
<span>  args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">'median'</span>, by <span class="op">=</span> <span class="st">'rows'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">newx</span>, n <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="co">#&gt;    S1 S2 S3 S4 S5 S6 S7 S8 S9 S10</span></span>
<span><span class="co">#&gt; g1  1 -1 -1  1 -1  1  1 -1  1  -1</span></span>
<span><span class="co">#&gt; g2 -1 -1  1  1  1 -1 -1 -1  1   1</span></span>
<span><span class="co">#&gt; g3 -1  1  1  1 -1 -1 -1  1 -1   1</span></span>
<span><span class="co">#&gt; g4  1  1  1 -1 -1  1  1 -1 -1  -1</span></span>
<span><span class="co">#&gt; g5  1 -1  1 -1  1  1 -1 -1 -1   1</span></span>
<span><span class="co">#&gt; g6  1 -1  1  1  1 -1 -1 -1 -1   1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary-scores">Summary Scores<a class="anchor" aria-label="anchor" href="#summary-scores"></a>
</h2>
<p>A list of currently supported scores is available through the
<code><a href="../reference/getAvailableScores.html">?getAvailableScores</a></code> function call, which returns a table
with two columns:</p>
<ul>
<li>
<code>id</code>: the id of the summary score, to be used in the
function calls</li>
<li>
<code>name</code>: the name of the summary score</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#list summary scores</span></span>
<span><span class="va">summary.scores</span> <span class="op">=</span> <span class="fu"><a href="../reference/getAvailableScores.html">getAvailableScores</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print in table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">summary.scores</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="18%">
<col width="18%">
<col width="62%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">id</th>
<th align="left">name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">sum</td>
<td align="left">sum</td>
<td align="left">Sum</td>
</tr>
<tr class="even">
<td align="left">weightedSum</td>
<td align="left">weightedSum</td>
<td align="left">Weighted Sum</td>
</tr>
<tr class="odd">
<td align="left">mean</td>
<td align="left">mean</td>
<td align="left">Arithmetic Mean</td>
</tr>
<tr class="even">
<td align="left">trimmedMean</td>
<td align="left">trimmedMean</td>
<td align="left">Trimmed Mean</td>
</tr>
<tr class="odd">
<td align="left">weightedMean</td>
<td align="left">weightedMean</td>
<td align="left">Weighted Mean</td>
</tr>
<tr class="even">
<td align="left">median</td>
<td align="left">median</td>
<td align="left">Median</td>
</tr>
<tr class="odd">
<td align="left">mode</td>
<td align="left">mode</td>
<td align="left">Mode</td>
</tr>
<tr class="even">
<td align="left">midrange</td>
<td align="left">midrange</td>
<td align="left">Midrange</td>
</tr>
<tr class="odd">
<td align="left">midhinge</td>
<td align="left">midhinge</td>
<td align="left">Midhinge</td>
</tr>
<tr class="even">
<td align="left">trimean</td>
<td align="left">trimean</td>
<td align="left">Trimean</td>
</tr>
<tr class="odd">
<td align="left">iqr</td>
<td align="left">iqr</td>
<td align="left">Interquartile Range</td>
</tr>
<tr class="even">
<td align="left">iqm</td>
<td align="left">iqm</td>
<td align="left">Interquartile Mean</td>
</tr>
<tr class="odd">
<td align="left">mad</td>
<td align="left">mad</td>
<td align="left">Median Absolute Deviation</td>
</tr>
<tr class="even">
<td align="left">aad</td>
<td align="left">aad</td>
<td align="left">Average Absolute Deviation</td>
</tr>
<tr class="odd">
<td align="left">ssgsea</td>
<td align="left">ssgsea</td>
<td align="left">Single Sample Gene Set Enrichment Analysis</td>
</tr>
<tr class="even">
<td align="left">gsva</td>
<td align="left">gsva</td>
<td align="left">Gene Set Variation Analysis</td>
</tr>
<tr class="odd">
<td align="left">plage</td>
<td align="left">plage</td>
<td align="left">Pathway Level Analysis of Gene Expression</td>
</tr>
<tr class="even">
<td align="left">zscore</td>
<td align="left">zscore</td>
<td align="left">Z-Score</td>
</tr>
</tbody>
</table>
<p>As we previously wrote, <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code> accepts in
input summary score ids or scorers.</p>
<div class="section level3">
<h3 id="score-ids">Score IDs<a class="anchor" aria-label="anchor" href="#score-ids"></a>
</h3>
<p>We can extract the ids by selecting the <code>id</code> column in the
previous table.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#summary score ids</span></span>
<span><span class="va">summary.scores.ids</span> <span class="op">=</span> <span class="va">summary.scores</span><span class="op">$</span><span class="va">id</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summary.scores.ids</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "sum"          "weightedSum"  "mean"         "trimmedMean"  "weightedMean"</span></span>
<span><span class="co">#&gt;  [6] "median"       "mode"         "midrange"     "midhinge"     "trimean"     </span></span>
<span><span class="co">#&gt; [11] "iqr"          "iqm"          "mad"          "aad"          "ssgsea"      </span></span>
<span><span class="co">#&gt; [16] "gsva"         "plage"        "zscore"</span></span></code></pre></div>
<p>Internally, the score ids are used to create scorers, that will be
used for the computation of the scores.</p>
</div>
<div class="section level3">
<h3 id="scorers">Scorers<a class="anchor" aria-label="anchor" href="#scorers"></a>
</h3>
<p>Under the hood, <code>sigscores</code> uses scorers, i.e. functions
that compute the summary scores. All scorers in <code>sigscores</code>
share some common parameters:</p>
<ul>
<li>
<code>x</code>: a (named) numerical vector or matrix</li>
<li>
<code>i</code>: a signature</li>
<li>
<code>na.rm</code>: a logical value, indicating whether to remove
<code>NA</code> values before the computation of the score</li>
<li>
<code>...</code>: further parameters to the specific scoring
function</li>
<li>
<code>transform.fun</code>: it is used to provide a transformation
function</li>
<li>
<code>transform.args</code>: a list containing the parameters for
<code>transform.fun</code>
</li>
<li>
<code>transform.sub</code>: a logical value indicating whether to
transform <code>x</code> after it is subset for the signature
<code>i</code> (used to speedup computation, as transformation function
should take less time on a reduced data set)</li>
</ul>
<p>The option of providing a data transformer to a scorer is given to
facilitate the application of specific transformation functions to a
selected summary measure via an automated process.</p>
<p>We can retrieve a scorer by providing a single score id to the
function <code><a href="../reference/getScorer.html">?getScorer</a></code> or multiple ids to
<code><a href="../reference/getScorers.html">?getScorers</a></code>. For example, let’s get the scorer for a
weighted sum. We know the related score id
(i.e. <code>weightedSum</code>) from the table obtained through the
<code><a href="../reference/getAvailableScores.html">?getAvailableScores</a></code> function call, so to obtain the scorer
we can do:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#get one scorer</span></span>
<span><span class="va">scorer</span> <span class="op">=</span> <span class="fu"><a href="../reference/getScorer.html">getScorer</a></span><span class="op">(</span>score <span class="op">=</span> <span class="st">"weightedSum"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#see function</span></span>
<span><span class="va">scorer</span></span>
<span><span class="co">#&gt; function (x, i = NULL, w = NULL, na.rm = TRUE, transform.fun = NULL, </span></span>
<span><span class="co">#&gt;     transform.args = list(), transform.sub = F) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     if (isTRUE(!is.null(transform.fun) &amp;&amp; is.function(transform.fun))) {</span></span>
<span><span class="co">#&gt;         x = do.call(what = transform.fun, args = c(list(x = x), </span></span>
<span><span class="co">#&gt;             transform.args))</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (isTRUE(!is.null(i))) {</span></span>
<span><span class="co">#&gt;         x = x[i, , drop = F]</span></span>
<span><span class="co">#&gt;         w = w[i]</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (isTRUE(!is.null(w))) {</span></span>
<span><span class="co">#&gt;         out = w * x</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     else {</span></span>
<span><span class="co">#&gt;         out = x</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     out = matrixStats::colSums2(x = out, na.rm = na.rm)</span></span>
<span><span class="co">#&gt;     out = unlist(out)</span></span>
<span><span class="co">#&gt;     return(out)</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x55608184a690&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: namespace:sigscores&gt;</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="compute-the-scores">Compute the Scores<a class="anchor" aria-label="anchor" href="#compute-the-scores"></a>
</h2>
<p>Finally, we can compute our summary scores.</p>
<div class="section level3">
<h3 id="using-scores">Using <code>scores</code><a class="anchor" aria-label="anchor" href="#using-scores"></a>
</h3>
<p>The easiest way for doing so is by passing the score ids to the
function via the <code>scores</code> argument. Internally, a scoring
function is retrieved for each provided score id by calling
<code><a href="../reference/getScorers.html">?getScorers</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x      <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i      <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm  <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scores <span class="op">=</span> <span class="va">summary.scores.ids</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sampleID   sum weightedSum   mean trimmedMean weightedMean median mode</span></span>
<span><span class="co">#&gt; S1       S1 13331       13331 666.55      666.55       666.55  736.5  137</span></span>
<span><span class="co">#&gt; S2       S2 12280       12280 614.00      614.00       614.00  623.0  233</span></span>
<span><span class="co">#&gt; S3       S3  8242        8242 412.10      412.10       412.10  366.5   13</span></span>
<span><span class="co">#&gt; S4       S4 11360       11360 568.00      568.00       568.00  562.0   53</span></span>
<span><span class="co">#&gt; S5       S5  8580        8580 429.00      429.00       429.00  323.0   43</span></span>
<span><span class="co">#&gt; S6       S6 11137       11137 556.85      556.85       556.85  519.0   77</span></span>
<span><span class="co">#&gt;    midrange midhinge  trimean    iqr   iqm      mad    aad      ssgsea</span></span>
<span><span class="co">#&gt; S1    557.0  680.375 708.4375 303.25 720.0 180.8772 178.65  0.89773866</span></span>
<span><span class="co">#&gt; S2    610.0  594.125 608.5625 389.25 619.3 322.4655 202.80  0.87143168</span></span>
<span><span class="co">#&gt; S3    499.0  409.750 388.1250 438.50 373.1 376.5804 242.20 -0.06961626</span></span>
<span><span class="co">#&gt; S4    521.5  574.500 568.2500 532.50 567.1 401.7846 271.30  0.71651992</span></span>
<span><span class="co">#&gt; S5    478.0  437.500 380.2500 503.50 384.4 297.2613 243.30  0.11853850</span></span>
<span><span class="co">#&gt; S6    521.0  547.500 533.2500 387.00 529.9 263.1615 216.75  0.44551534</span></span>
<span><span class="co">#&gt;           gsva      plage     zscore</span></span>
<span><span class="co">#&gt; S1  0.34677243 -0.3210647  2.1673343</span></span>
<span><span class="co">#&gt; S2  0.35961538  0.2938191  1.1924762</span></span>
<span><span class="co">#&gt; S3 -0.40000000  0.5088480 -1.9536056</span></span>
<span><span class="co">#&gt; S4  0.17308020 -0.1577183  0.4199618</span></span>
<span><span class="co">#&gt; S5 -0.14416667  0.1773275 -1.2097106</span></span>
<span><span class="co">#&gt; S6  0.07086466 -0.3916968  0.5601269</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-scorers">Using <code>scorers</code><a class="anchor" aria-label="anchor" href="#using-scorers"></a>
</h3>
<p>Alternatively, we can define our own list by providing scoring
functions. Let’s retrieve two scorers by using the function
<code><a href="../reference/getScorer.html">?getScorer</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create scorers list</span></span>
<span><span class="va">scorers</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">'mean'</span>     <span class="op">=</span> <span class="fu"><a href="../reference/getScorer.html">getScorer</a></span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span>,</span>
<span>  <span class="st">'midpoint'</span> <span class="op">=</span> <span class="fu"><a href="../reference/getScorer.html">getScorer</a></span><span class="op">(</span><span class="st">"median"</span><span class="op">)</span><span class="co">#we name this score 'midpoint'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x      <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i      <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm  <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scorers <span class="op">=</span> <span class="va">scorers</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sampleID   mean midpoint</span></span>
<span><span class="co">#&gt; S1       S1 666.55    736.5</span></span>
<span><span class="co">#&gt; S2       S2 614.00    623.0</span></span>
<span><span class="co">#&gt; S3       S3 412.10    366.5</span></span>
<span><span class="co">#&gt; S4       S4 568.00    562.0</span></span>
<span><span class="co">#&gt; S5       S5 429.00    323.0</span></span>
<span><span class="co">#&gt; S6       S6 556.85    519.0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="changing-default-arguments">Changing Default Arguments<a class="anchor" aria-label="anchor" href="#changing-default-arguments"></a>
</h3>
<p>To change the default arguments of a specific score function, we can
use <code>args</code>: the argument accept a named list, where the name
of the element must match the id of the score we want to compute. For
example, we may want to compute a trimmed mean considering a specific
fraction of elements to be trimmed from each end. Looking at the
documentation of <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code> we can see the scorer
computing the trimmed mean is called <code><a href="../reference/trimmedMeanScorer.html">?trimmedMeanScorer</a></code>,
which accepts an argument <code>trim</code>. We can then pass the
argument from <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code> via <code>args</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x      <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i      <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm  <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scores <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>  args   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trimmedMean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trim <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sampleID   sum weightedSum   mean trimmedMean weightedMean median mode</span></span>
<span><span class="co">#&gt; S1       S1 13331       13331 666.55    712.5833       666.55  736.5  137</span></span>
<span><span class="co">#&gt; S2       S2 12280       12280 614.00    615.1667       614.00  623.0  233</span></span>
<span><span class="co">#&gt; S3       S3  8242        8242 412.10    376.5833       412.10  366.5   13</span></span>
<span><span class="co">#&gt; S4       S4 11360       11360 568.00    568.0833       568.00  562.0   53</span></span>
<span><span class="co">#&gt; S5       S5  8580        8580 429.00    395.0000       429.00  323.0   43</span></span>
<span><span class="co">#&gt; S6       S6 11137       11137 556.85    543.3333       556.85  519.0   77</span></span>
<span><span class="co">#&gt;    midrange midhinge  trimean    iqr   iqm      mad    aad      ssgsea</span></span>
<span><span class="co">#&gt; S1    557.0  680.375 708.4375 303.25 720.0 180.8772 178.65  0.89773866</span></span>
<span><span class="co">#&gt; S2    610.0  594.125 608.5625 389.25 619.3 322.4655 202.80  0.87143168</span></span>
<span><span class="co">#&gt; S3    499.0  409.750 388.1250 438.50 373.1 376.5804 242.20 -0.06961626</span></span>
<span><span class="co">#&gt; S4    521.5  574.500 568.2500 532.50 567.1 401.7846 271.30  0.71651992</span></span>
<span><span class="co">#&gt; S5    478.0  437.500 380.2500 503.50 384.4 297.2613 243.30  0.11853850</span></span>
<span><span class="co">#&gt; S6    521.0  547.500 533.2500 387.00 529.9 263.1615 216.75  0.44551534</span></span>
<span><span class="co">#&gt;           gsva      plage     zscore</span></span>
<span><span class="co">#&gt; S1  0.34677243 -0.3210647  2.1673343</span></span>
<span><span class="co">#&gt; S2  0.35961538  0.2938191  1.1924762</span></span>
<span><span class="co">#&gt; S3 -0.40000000  0.5088480 -1.9536056</span></span>
<span><span class="co">#&gt; S4  0.17308020 -0.1577183  0.4199618</span></span>
<span><span class="co">#&gt; S5 -0.14416667  0.1773275 -1.2097106</span></span>
<span><span class="co">#&gt; S6  0.07086466 -0.3916968  0.5601269</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="scorers-and-args">
<code>scorers</code> and <code>args</code><a class="anchor" aria-label="anchor" href="#scorers-and-args"></a>
</h3>
<p>By using <code>scorers</code> and <code>args</code> we can define our
list of scorers having specific names and parameters.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create scorers list</span></span>
<span><span class="va">scorers</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">'trimmedMean03'</span> <span class="op">=</span> <span class="fu"><a href="../reference/getScorer.html">getScorer</a></span><span class="op">(</span><span class="st">"trimmedMean"</span><span class="op">)</span>,</span>
<span>  <span class="st">'trimmedMean04'</span> <span class="op">=</span> <span class="fu"><a href="../reference/getScorer.html">getScorer</a></span><span class="op">(</span><span class="st">"trimmedMean"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores2</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x      <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i      <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm  <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scorers <span class="op">=</span> <span class="va">scorers</span>,</span>
<span>  args   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    trimmedMean03 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trim <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>    trimmedMean04 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trim <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scores2</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sampleID trimmedMean03 trimmedMean04</span></span>
<span><span class="co">#&gt; S1       S1       729.500        736.00</span></span>
<span><span class="co">#&gt; S2       S2       625.625        619.00</span></span>
<span><span class="co">#&gt; S3       S3       362.625        362.25</span></span>
<span><span class="co">#&gt; S4       S4       565.125        559.50</span></span>
<span><span class="co">#&gt; S5       S5       372.000        336.50</span></span>
<span><span class="co">#&gt; S6       S6       530.750        525.25</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="transforming-the-data">Transforming the Data<a class="anchor" aria-label="anchor" href="#transforming-the-data"></a>
</h3>
<p>To facilitate the application of specific transformation functions to
selected scores via an automated process, it is possible to provide a
data transformer in input to the scorers. The provided transformer is
used to transform the data before the computation of the scores.</p>
<p>To pass the needed parameters to the scorer from
<code><a href="../reference/computeSigScores.html">?computeSigScores</a></code> we can again use <code>args</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Transform data and compute the scores</span></span>
<span><span class="va">scoresTD</span> <span class="op">=</span> <span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  scorers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>   <span class="st">'score1'</span> <span class="op">=</span> <span class="fu"><a href="../reference/getScorer.html">getScorer</a></span><span class="op">(</span><span class="st">'weightedSum'</span><span class="op">)</span>,</span>
<span>   <span class="st">'score2'</span> <span class="op">=</span> <span class="fu"><a href="../reference/getScorer.html">getScorer</a></span><span class="op">(</span><span class="st">'trimmedMean'</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>   <span class="st">'score1'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      transform.fun <span class="op">=</span> <span class="fu"><a href="../reference/getDataTransformer.html">getDataTransformer</a></span><span class="op">(</span><span class="st">'quantile'</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>   <span class="st">'score2'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      trim <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>      transform.fun <span class="op">=</span> <span class="fu"><a href="../reference/getDataTransformer.html">getDataTransformer</a></span><span class="op">(</span><span class="st">'stepFunction'</span><span class="op">)</span>,</span>
<span>      transform.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        method <span class="op">=</span> <span class="st">'median'</span>,</span>
<span>        by <span class="op">=</span> <span class="st">'rows'</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scoresTD</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sampleID  score1     score2</span></span>
<span><span class="co">#&gt; S1       S1 12533.2  0.8333333</span></span>
<span><span class="co">#&gt; S2       S2 12396.8  0.0000000</span></span>
<span><span class="co">#&gt; S3       S3  8713.9 -0.5000000</span></span>
<span><span class="co">#&gt; S4       S4 11591.0  0.1666667</span></span>
<span><span class="co">#&gt; S5       S5  9712.2 -0.3333333</span></span>
<span><span class="co">#&gt; S6       S6 10637.2  0.0000000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="visualisation">Visualisation<a class="anchor" aria-label="anchor" href="#visualisation"></a>
</h2>
<p><code>sigscores</code> provides some basic functions for plotting.
For example, we can plot our computed results via an heat map by using
the <code><a href="../reference/heatmapSigScores.html">?heatmapSigScores</a></code> function, which requires the output
of <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code> as the <code>data</code>
parameter.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create plot</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/heatmapSigScores.html">heatmapSigScores</a></span><span class="op">(</span></span>
<span>  data   <span class="op">=</span> <span class="va">scores</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#visualise</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="sigscores_files/figure-html/summary_scores_w_args_plot_heatmap-1.png" width="576"></p>
<p>We can visualise the correlation of the summary scores by using
another built-in function, i.e. <code><a href="../reference/heatmapCorSigScores.html">?heatmapCorSigScores</a></code>. The
correlation matrix can be directly provided via the <code>cor</code>
parameter. If <code>cor = NULL</code>, <code><a href="../reference/heatmapCorSigScores.html">?heatmapCorSigScores</a></code>
internally computes the correlation by using the default settings of
<code><a href="../reference/computeSigScoresCorrelation.html">?computeSigScoresCorrelation</a></code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create plot</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/heatmapCorSigScores.html">heatmapCorSigScores</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">scores</span>,</span>
<span>  cor  <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#visualise</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="sigscores_files/figure-html/summary_scores_correlation_plot_heatmap-1.png" width="576"></p>
<p>It is also possible to represent the summary scores via box plots
thanks to another built-in function,
i.e. <code><a href="../reference/boxplotSigScores.html">?boxplotSigScores</a></code>. We can also subset the scores we
want to plot by using the <code>scores</code> parameter.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create plot</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/boxplotSigScores.html">boxplotSigScores</a></span><span class="op">(</span></span>
<span>  data   <span class="op">=</span> <span class="va">scores</span>,</span>
<span>  scores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"mode"</span>, <span class="st">"median"</span>, <span class="st">"iqm"</span>, <span class="st">"midrange"</span>, <span class="st">"midhinge"</span>, <span class="st">"trimean"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#visualise</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="sigscores_files/figure-html/summary_scores_plot_boxplot-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="significance-of-the-scores">Significance of the Scores<a class="anchor" aria-label="anchor" href="#significance-of-the-scores"></a>
</h2>
<p>We may want to understand if the computed scores are due to the
selected genes in our signature, or if we might have ended up with
similar scores also with different lists of genes.</p>
<div class="section level3">
<h3 id="sampling-the-data">Sampling the Data<a class="anchor" aria-label="anchor" href="#sampling-the-data"></a>
</h3>
<p>To associate significance to each of the computed scores we can use a
resampling method. The idea is to calculate the probability of observing
a resampling value as extreme as the one calculated on the original
data. The main steps involved in this process are:</p>
<ol style="list-style-type: decimal">
<li>Draw random samples from the original data</li>
<li>Compute the summary scores on the simulated data</li>
<li>Create a sampling distribution for each score</li>
<li>Calculate the significance for each score</li>
</ol>
<p>To facilitate this computation, <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code> can
also calculate the summary scores for data sets generated using
resampling. Two techniques are provided out-of-the-box in
<code><a href="../reference/computeSigScores.html">?computeSigScores</a></code>: <strong>permutation</strong>
(i.e. sampling without replacement) and <strong>bootstrap</strong>
(i.e. sampling with replacement). The main new arguments we need to set
are <code>sampling</code>, which indicates the technique we want to use,
and <code>n.repeat</code>, which tells the function how many random
samples we want to generate.</p>
<p>Let’s create summary scores for 10 data sets generated using sampling
without replacement.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm    <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>  sampling <span class="op">=</span> <span class="st">"permutation"</span>,</span>
<span>  n.repeat <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span>
<span><span class="co">#&gt;   run sampleID   sum weightedSum   mean trimmedMean weightedMean median mode</span></span>
<span><span class="co">#&gt; 1   1       S1  7277        7277 363.85      363.85       363.85  261.0    2</span></span>
<span><span class="co">#&gt; 2   1       S2  9930        9930 496.50      496.50       496.50  507.5    3</span></span>
<span><span class="co">#&gt; 3   1       S3  8750        8750 437.50      437.50       437.50  384.0   81</span></span>
<span><span class="co">#&gt; 4   1       S4  9134        9134 456.70      456.70       456.70  399.0   51</span></span>
<span><span class="co">#&gt; 5   1       S5  7427        7427 371.35      371.35       371.35  319.0    8</span></span>
<span><span class="co">#&gt; 6   1       S6 11418       11418 570.90      570.90       570.90  571.0  149</span></span>
<span><span class="co">#&gt;   midrange midhinge  trimean    iqr   iqm      mad    aad      ssgsea</span></span>
<span><span class="co">#&gt; 1    449.0  357.750 309.3750 641.50 305.3 352.1175 285.95 -0.49970900</span></span>
<span><span class="co">#&gt; 2    489.0  489.250 498.3750 356.50 489.6 283.9179 215.40  0.19929221</span></span>
<span><span class="co">#&gt; 3    539.0  372.500 378.2500 408.00 357.4 346.9284 259.30  0.01770463</span></span>
<span><span class="co">#&gt; 4    520.5  479.875 439.4375 343.25 432.2 293.5548 214.10  0.11019309</span></span>
<span><span class="co">#&gt; 5    454.0  379.750 349.3750 432.00 336.9 302.4504 223.85 -0.21291592</span></span>
<span><span class="co">#&gt; 6    557.0  552.125 561.5625 430.25 574.7 349.8936 225.40  0.49461406</span></span>
<span><span class="co">#&gt;          gsva        plage     zscore</span></span>
<span><span class="co">#&gt; 1 -0.39186257 -0.430876879 -1.3739329</span></span>
<span><span class="co">#&gt; 2  0.04742293 -0.002122875  0.3751179</span></span>
<span><span class="co">#&gt; 3  0.11666667 -0.385513783 -0.8065714</span></span>
<span><span class="co">#&gt; 4  0.12758728 -0.088276998 -0.1428458</span></span>
<span><span class="co">#&gt; 5 -0.11662996 -0.209271662 -1.3765625</span></span>
<span><span class="co">#&gt; 6  0.44561404  0.453742266  1.6396185</span></span></code></pre></div>
<p>To use bootstrap instead, we just need change the
<code>sampling</code> argument.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm    <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>  sampling <span class="op">=</span> <span class="st">"bootstrap"</span>,</span>
<span>  n.repeat <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">scores</span>, n <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="co">#&gt;   run sampleID   sum weightedSum   mean trimmedMean weightedMean median mode</span></span>
<span><span class="co">#&gt; 1   1       S1 10628       10628 531.40      531.40       531.40  692.0  692</span></span>
<span><span class="co">#&gt; 2   1       S2  9163        9163 458.15      458.15       458.15  361.5   32</span></span>
<span><span class="co">#&gt; 3   1       S3 10665       10665 533.25      533.25       533.25  584.5  563</span></span>
<span><span class="co">#&gt; 4   1       S4  7325        7325 366.25      366.25       366.25  409.5   22</span></span>
<span><span class="co">#&gt; 5   1       S5  8657        8657 432.85      432.85       432.85  400.5    6</span></span>
<span><span class="co">#&gt; 6   1       S6 11009       11009 550.45      550.45       550.45  566.0  566</span></span>
<span><span class="co">#&gt;   midrange midhinge  trimean    iqr   iqm      mad    aad     ssgsea</span></span>
<span><span class="co">#&gt; 1    440.5  510.500 601.2500 524.50 601.4 262.4202 246.90  0.2382717</span></span>
<span><span class="co">#&gt; 2    503.5  478.125 419.8125 536.25 416.0 325.4307 258.95  0.2153395</span></span>
<span><span class="co">#&gt; 3    539.0  510.375 547.4375 590.75 545.3 404.0085 259.25  0.3853388</span></span>
<span><span class="co">#&gt; 4    420.0  339.500 374.5000 321.00 383.7 186.0663 181.45 -0.2816480</span></span>
<span><span class="co">#&gt; 5    472.0  437.625 419.0625 637.25 439.1 524.0991 305.45  0.1844530</span></span>
<span><span class="co">#&gt; 6    560.5  564.500 565.2500 479.00 559.7 352.8588 229.95  0.4535682</span></span>
<span><span class="co">#&gt;          gsva       plage     zscore</span></span>
<span><span class="co">#&gt; 1  0.16395191 -0.15801753  0.8728117</span></span>
<span><span class="co">#&gt; 2  0.12262433  0.42059271 -0.5968935</span></span>
<span><span class="co">#&gt; 3  0.09601648 -0.26930515  0.4721479</span></span>
<span><span class="co">#&gt; 4 -0.07842893  0.05836157 -1.3292259</span></span>
<span><span class="co">#&gt; 5 -0.26026423 -0.53494029 -0.4985339</span></span>
<span><span class="co">#&gt; 6  0.14792094  0.00608184  0.7195745</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="random-signatures">Random Signatures<a class="anchor" aria-label="anchor" href="#random-signatures"></a>
</h3>
<p>Instead of creating new data sets via resampling, we can also
generate random signatures, i.e. randomly generated vectors of the same
size as <code>i</code>.</p>
<p>To facilitate this computation, <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code>allows
two options: <strong>rndsig</strong> (where all elements - row indices -
of <code>x</code> can be randomly selected) and
<strong>rndsigsub</strong> (where only the elements - row indices - of
<code>x</code> that are not in <code>i</code> can be randomly selected).
We can still use the <code>sampling</code> parameter to indicate the
technique we want to use, and <code>n.repeat</code>, to tell the
function how many random signatures we want to generate.</p>
<p>Let’s create summary scores for 10 random signatures. For doing so,
we just need to write <code>sampling = 'rndsig'</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm    <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>  sampling <span class="op">=</span> <span class="st">"rndsig"</span>,</span>
<span>  n.repeat <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">scores</span>, n <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="co">#&gt;   run sampleID   sum weightedSum   mean trimmedMean weightedMean median mode</span></span>
<span><span class="co">#&gt; 1   1       S1 10642       10642 532.10      532.10       532.10  625.5    2</span></span>
<span><span class="co">#&gt; 2   1       S2  9849        9849 492.45      492.45       492.45  549.5    3</span></span>
<span><span class="co">#&gt; 3   1       S3 10235       10235 511.75      511.75       511.75  458.5   25</span></span>
<span><span class="co">#&gt; 4   1       S4  7217        7217 360.85      360.85       360.85  365.0   12</span></span>
<span><span class="co">#&gt; 5   1       S5  7658        7658 382.90      382.90       382.90  320.5    6</span></span>
<span><span class="co">#&gt; 6   1       S6 10667       10667 533.35      533.35       533.35  508.5  159</span></span>
<span><span class="co">#&gt;   midrange midhinge  trimean    iqr   iqm      mad    aad     ssgsea</span></span>
<span><span class="co">#&gt; 1    497.5  452.000 538.7500 556.50 578.0 282.4353 250.40  0.2919138</span></span>
<span><span class="co">#&gt; 2    435.0  489.250 519.3750 432.50 544.7 243.1464 217.45  0.3374312</span></span>
<span><span class="co">#&gt; 3    511.0  504.625 481.5625 343.75 515.0 347.6697 249.55  0.4744933</span></span>
<span><span class="co">#&gt; 4    433.0  318.250 341.6250 504.50 329.8 347.6697 230.15 -0.4304196</span></span>
<span><span class="co">#&gt; 5    459.5  356.000 338.2500 511.50 349.9 395.8542 265.40 -0.0516426</span></span>
<span><span class="co">#&gt; 6    579.5  509.875 509.1875 330.75 510.7 268.3506 197.45  0.2885531</span></span>
<span><span class="co">#&gt;           gsva       plage      zscore</span></span>
<span><span class="co">#&gt; 1 -0.008088235 -0.43202354  0.67191640</span></span>
<span><span class="co">#&gt; 2 -0.039429175  0.29436181  0.06091783</span></span>
<span><span class="co">#&gt; 3  0.160119048  0.19256993  0.05269303</span></span>
<span><span class="co">#&gt; 4 -0.325217602  0.01629289 -1.81167058</span></span>
<span><span class="co">#&gt; 5 -0.160950413 -0.27036762 -1.47974905</span></span>
<span><span class="co">#&gt; 6  0.073752969  0.02685464  0.59379833</span></span></code></pre></div>
<p>A final available option is to generate random signatures by using
all possible elements of <code>x</code> after removing the value from
<code>i</code>. For this scenario, we just need to use
<code>sampling = 'rndsigsub'</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm    <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>  sampling <span class="op">=</span> <span class="st">"rndsigsub"</span>,</span>
<span>  n.repeat <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">scores</span>, n <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="co">#&gt;   run sampleID   sum weightedSum   mean trimmedMean weightedMean median mode</span></span>
<span><span class="co">#&gt; 1   1       S1 10228       10228 511.40      511.40       511.40  540.5   23</span></span>
<span><span class="co">#&gt; 2   1       S2  8830        8830 441.50      441.50       441.50  410.0  139</span></span>
<span><span class="co">#&gt; 3   1       S3  7995        7995 399.75      399.75       399.75  312.0   81</span></span>
<span><span class="co">#&gt; 4   1       S4 10317       10317 515.85      515.85       515.85  441.5   12</span></span>
<span><span class="co">#&gt; 5   1       S5  8570        8570 428.50      428.50       428.50  391.5   46</span></span>
<span><span class="co">#&gt; 6   1       S6 12061       12061 603.05      603.05       603.05  648.5  159</span></span>
<span><span class="co">#&gt;   midrange midhinge  trimean    iqr   iqm      mad    aad      ssgsea</span></span>
<span><span class="co">#&gt; 1    470.5  537.750 539.1250 321.00 516.0 243.1464 209.10  0.03927932</span></span>
<span><span class="co">#&gt; 2    505.5  425.000 417.5000 330.00 426.8 269.8332 189.60 -0.24184922</span></span>
<span><span class="co">#&gt; 3    493.0  428.250 370.1250 445.00 340.8 237.9573 217.55 -0.28906294</span></span>
<span><span class="co">#&gt; 4    501.0  524.125 482.8125 361.25 495.0 295.7787 233.35  0.45904479</span></span>
<span><span class="co">#&gt; 5    502.5  420.000 405.7500 532.50 406.6 413.6454 283.70  0.15920415</span></span>
<span><span class="co">#&gt; 6    574.0  607.500 628.0000 289.50 614.3 254.2659 193.15  0.71093706</span></span>
<span><span class="co">#&gt;         gsva       plage     zscore</span></span>
<span><span class="co">#&gt; 1 -0.1566852  0.16191884  0.2105943</span></span>
<span><span class="co">#&gt; 2 -0.3464539  0.04897823 -0.8893993</span></span>
<span><span class="co">#&gt; 3 -0.2420918 -0.17507515 -1.6517839</span></span>
<span><span class="co">#&gt; 4  0.1799296  0.24197781  0.4720690</span></span>
<span><span class="co">#&gt; 5 -0.0862254  0.48313859 -0.5202871</span></span>
<span><span class="co">#&gt; 6  0.3174731 -0.41419008  1.6535733</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="logging">Logging<a class="anchor" aria-label="anchor" href="#logging"></a>
</h2>
<p><strong>sigscores</strong> provides a basic event logging system. It
can be easily set-up by providing a <code><a href="../reference/Logger.html">?Logger</a></code> to
<code><a href="../reference/computeSigScores.html">?computeSigScores</a></code>. A <code><a href="../reference/Logger.html">?Logger</a></code> can be created by
calling the <code><a href="../reference/createLogger.html">?createLogger</a></code> function.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm    <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>  logger   <span class="op">=</span> <span class="fu"><a href="../reference/createLogger.html">createLogger</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span>, level <span class="op">=</span> <span class="st">"DEBUG"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [INFO]  2025-06-29 13:06:31.457198 SIGSCORES</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.458441 Starting the computation.</span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.458695 Iteration 1</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.458854 Iteration 2</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.458994 Iteration 3</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.459124 Iteration 4</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.459399 Iteration 5</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.459558 Iteration 6</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.459699 Iteration 7</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.46096 Iteration 8</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.461123 Iteration 9</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.462688 Iteration 10</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.464547 Iteration 11</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.465956 Iteration 12</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.466635 Iteration 13</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.466801 Iteration 14</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.467019 Iteration 15</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.506956 Iteration 16</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.535501 Iteration 17</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.551028 Iteration 18</span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.566897 Computation finished.</span></span>
<span><span class="co">#&gt; [DEBUG] 2025-06-29 13:06:31.56705 Creating output object...DONE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="save-to-file">Save to File<a class="anchor" aria-label="anchor" href="#save-to-file"></a>
</h2>
<p>The result of the computation and a log file can be automatically
saved to disk.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#define your output directory</span></span>
<span><span class="va">outdir</span> <span class="op">=</span> <span class="st">"mydir/test"</span></span>
<span><span class="co">#choose a name for the result file</span></span>
<span><span class="co">#(without file extension)</span></span>
<span><span class="va">resfile</span> <span class="op">=</span> <span class="st">"sigscores"</span></span>
<span><span class="co">#choose a name for the log file</span></span>
<span><span class="co">#(with file extension)</span></span>
<span><span class="va">logfile</span> <span class="op">=</span> <span class="st">"log.txt"</span></span>
<span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm    <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>  logger   <span class="op">=</span> <span class="fu"><a href="../reference/createLogger.html">createLogger</a></span><span class="op">(</span></span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    level   <span class="op">=</span> <span class="st">"DEBUG"</span>,</span>
<span>    path    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outdir</span>, <span class="va">logfile</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  outdir   <span class="op">=</span> <span class="va">outdir</span>,</span>
<span>  filename <span class="op">=</span> <span class="va">resfile</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parallel-execution">Parallel Execution<a class="anchor" aria-label="anchor" href="#parallel-execution"></a>
</h2>
<p><strong>sigscores</strong> provides a simple approach to speed up
computation on a multi-core computer via the usage of <a href="https://stat.ethz.ch/R-manual/R-devel/library/parallel/html/00Index.html" class="external-link">parallel</a>,
<a href="https://cran.r-project.org/package=doParallel" class="external-link">doParallel</a>,
and <a href="https://cran.r-project.org/package=foreach" class="external-link">foreach</a> R
packages.</p>
<p>To enable parallel execution we just need to set the argument
<code>cores</code> in the <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code> function with
an integer greater than 1. For example, let’s try to use 2 cores.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores with parallel execution</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm    <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>  sampling <span class="op">=</span> <span class="st">"permutation"</span>,</span>
<span>  n.repeat <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  cores    <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>As a note, the function internally perform some checks before setting
a parallel environment, so if the provided number of cores is too high
it will set <code>cores</code> as the maximum number of available
(logical) processors on the machine minus 1.</p>
<div class="section level3">
<h3 id="serial-vs-parallel">Serial vs Parallel<a class="anchor" aria-label="anchor" href="#serial-vs-parallel"></a>
</h3>
<p>We could see the advantage of using a parallel execution by comparing
the computation time between a serial and parallel setting when having
an higher number of repeats. To time the execution of the function calls
we can use the <code><a href="https://rdrr.io/r/base/system.time.html" class="external-link">?system.time</a></code> R function.</p>
<p>Let’s consider 500 permutations of the original data and compute the
scores in a serial fashion first.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">time_serial</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  expr <span class="op">=</span> <span class="op">{</span></span>
<span>    <span class="va">scoresS</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>      x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>      i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>      na.rm    <span class="op">=</span> <span class="cn">T</span>,</span>
<span>      scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>      sampling <span class="op">=</span> <span class="st">"permutation"</span>,</span>
<span>      n.repeat <span class="op">=</span> <span class="fl">500</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we can run the parallel execution with the same number of repeats
and selecting 5 cores.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">time_parallel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  expr <span class="op">=</span> <span class="op">{</span></span>
<span>    <span class="va">scoresP</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>      x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>      i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>      na.rm    <span class="op">=</span> <span class="cn">T</span>,</span>
<span>      scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>      sampling <span class="op">=</span> <span class="st">"permutation"</span>,</span>
<span>      n.repeat <span class="op">=</span> <span class="fl">500</span>,</span>
<span>      cores    <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can compare the execution time. On a laptop having the
following hardware:</p>
<ul>
<li>Intel(R) Core(TM) i7-8650 CPU @ 1.90GHz, 2112MHz, 4 Core(s), 8
Logical Processor(s)</li>
<li>1TB SSD Hard Drive</li>
<li>16GB RAM</li>
</ul>
<p>the execution times for the serial and parallel computations
were:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create a matrix</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  serial   <span class="op">=</span> <span class="va">time_serial</span>,</span>
<span>  parallel <span class="op">=</span> <span class="va">time_parallel</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt;          user.self sys.self elapsed user.child sys.child</span></span>
<span><span class="co">#&gt; serial      170.17     0.06  170.50         NA        NA</span></span>
<span><span class="co">#&gt; parallel      1.20     2.08   84.03         NA        NA</span></span></code></pre></div>
<p>The parallel execution was around 2.03 times faster than the serial
execution.</p>
<!-- ## Session Info -->
<!-- The version number of R and packages loaded for generating the vignette. -->
<!-- ```{r session_info} -->
<!-- sessionInfo() -->
<!-- ``` -->
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alessandro Barberis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
