<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sigscores">
<title>An introduction to `sigscores` • sigscores</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to `sigscores`">
<meta property="og:description" content="sigscores">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sigscores</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/sigscores.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alebarberis/sigscores/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>An introduction to `sigscores`</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/alebarberis/sigscores/blob/HEAD/vignettes/sigscores.Rmd" class="external-link"><code>vignettes/sigscores.Rmd</code></a></small>
      <div class="d-none name"><code>sigscores.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>sigscores</strong> is an helpful package providing an easy
way to compute summary scores for gene signatures.</p>
<p>There is one main function <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code>, that can
be used to compute all the available scores.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Firstly, we load <code>sigscores</code> and other needed
packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alebarberis/sigscores" class="external-link">sigscores</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'sigscores'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:methods':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     getPackageName</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="seed">Seed<a class="anchor" aria-label="anchor" href="#seed"></a>
</h2>
<p>Now we want to set a seed for the random number generation (RNG). In
fact, different R sessions have different seeds created from current
time and process ID by default, and consequently different simulation
results. By fixing a seed we ensure we will be able to reproduce the
results of this vignette. We can specify a seed by calling
<code><a href="https://rdrr.io/r/base/Random.html" class="external-link">?set.seed</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Set a seed for RNG</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span></span>
<span>  <span class="co">#A seed</span></span>
<span>  seed <span class="op">=</span> <span class="fl">5381L</span>,                   <span class="co">#a randomly chosen integer value</span></span>
<span>  <span class="co">#The kind of RNG to use</span></span>
<span>  kind <span class="op">=</span> <span class="st">"Mersenne-Twister"</span>,      <span class="co">#we make explicit the current R default value</span></span>
<span>  <span class="co">#The kind of Normal generation</span></span>
<span>  normal.kind <span class="op">=</span> <span class="st">"Inversion"</span>       <span class="co">#we make explicit the current R default value</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary-scores">Summary Scores<a class="anchor" aria-label="anchor" href="#summary-scores"></a>
</h2>
<p>A list of currently supported scores is available through the
<code><a href="../reference/getAvailableScores.html">?getAvailableScores</a></code> function call.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#list methods</span></span>
<span><span class="va">summary.scores</span> <span class="op">=</span> <span class="fu"><a href="../reference/getAvailableScores.html">getAvailableScores</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print in table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">summary.scores</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">id</th>
<th align="left">name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">mean</td>
<td align="left">Arithmetic Mean</td>
</tr>
<tr class="even">
<td align="left">trimmedMean</td>
<td align="left">Trimmed Mean</td>
</tr>
<tr class="odd">
<td align="left">weightedMean</td>
<td align="left">Weighted Mean</td>
</tr>
<tr class="even">
<td align="left">IQM</td>
<td align="left">Interquartile Mean</td>
</tr>
<tr class="odd">
<td align="left">median</td>
<td align="left">Median</td>
</tr>
<tr class="even">
<td align="left">mode</td>
<td align="left">Mode</td>
</tr>
<tr class="odd">
<td align="left">midrange</td>
<td align="left">Midrange</td>
</tr>
<tr class="even">
<td align="left">midhinge</td>
<td align="left">Midhinge</td>
</tr>
<tr class="odd">
<td align="left">trimean</td>
<td align="left">Trimean</td>
</tr>
<tr class="even">
<td align="left">bristow</td>
<td align="left">Bristow Score</td>
</tr>
<tr class="odd">
<td align="left">reviewedBristow</td>
<td align="left">Reviewed Bristow Score</td>
</tr>
<tr class="even">
<td align="left">weightedSum</td>
<td align="left">Weighted Sum of Quantile Normalised Data</td>
</tr>
<tr class="odd">
<td align="left">ssGSEA</td>
<td align="left">Single Sample Gene Set Enrichment Analysis</td>
</tr>
<tr class="even">
<td align="left">gsva</td>
<td align="left">Gene Set Variation Analysis</td>
</tr>
<tr class="odd">
<td align="left">plage</td>
<td align="left">Pathway Level Analysis of Gene Expression</td>
</tr>
<tr class="even">
<td align="left">zscore</td>
<td align="left">Z-Score</td>
</tr>
</tbody>
</table>
<p>We can extract the ids by selecting the <code>id</code> column.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#learning method ids</span></span>
<span><span class="va">summary.scores.ids</span> <span class="op">=</span> <span class="va">summary.scores</span><span class="op">$</span><span class="va">id</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summary.scores.ids</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "mean"            "trimmedMean"     "weightedMean"    "IQM"            </span></span>
<span><span class="co">#&gt;  [5] "median"          "mode"            "midrange"        "midhinge"       </span></span>
<span><span class="co">#&gt;  [9] "trimean"         "bristow"         "reviewedBristow" "weightedSum"    </span></span>
<span><span class="co">#&gt; [13] "ssGSEA"          "gsva"            "plage"           "zscore"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>We create now some simulated data to use. For this vignette, we will
consider a matrix with 100 genes and 10 samples.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#number of samples</span></span>
<span><span class="va">nc</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="co">#number of genes</span></span>
<span><span class="va">nr</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="co">#create matrix</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nr</span><span class="op">*</span><span class="va">nc</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">nr</span>,</span>
<span>  ncol <span class="op">=</span> <span class="va">nc</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"g"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can inspect the data by using the <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">?head</a></code> function,
which returns the first parts of a vector, matrix, table, data frame or
function. Let’s print the first 6 rows of our matrix.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, n <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="co">#&gt;     S1  S2  S3  S4  S5  S6  S7  S8  S9 S10</span></span>
<span><span class="co">#&gt; g1 993 702 660 854 769 859 940 679 946 218</span></span>
<span><span class="co">#&gt; g2 585 620 941 714 994 369 602 506 981 674</span></span>
<span><span class="co">#&gt; g3 175 779 984 834 460 292 445 953 491 673</span></span>
<span><span class="co">#&gt; g4 778 855 293 140  29 601 980  82 161 115</span></span>
<span><span class="co">#&gt; g5 876  32 838  22 803 804 355 663  11 731</span></span>
<span><span class="co">#&gt; g6 835 462 894 560 885  88 442 199 541 725</span></span></code></pre></div>
<p>We can now define our gene signature. For example, we can randomly
select some genes from the matrix. Let’s select 20 genes.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#number of genes in signature</span></span>
<span><span class="va">ng</span> <span class="op">=</span> <span class="fl">20</span></span>
<span></span>
<span><span class="co">#select genes</span></span>
<span><span class="va">signature</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">ng</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="va">signature</span></span>
<span><span class="co">#&gt;  [1] "g12" "g41" "g23" "g59" "g93" "g70" "g51" "g53" "g20" "g72" "g78" "g48"</span></span>
<span><span class="co">#&gt; [13] "g67" "g46" "g36" "g7"  "g13" "g15" "g45" "g33"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="compute-the-scores">Compute the Scores<a class="anchor" aria-label="anchor" href="#compute-the-scores"></a>
</h2>
<p>Finally, we can compute our summary scores.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x      <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i      <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm  <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scores <span class="op">=</span> <span class="va">summary.scores.ids</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sampleID   mean trimmedMean weightedMean   IQM median mode midrange midhinge</span></span>
<span><span class="co">#&gt; S1       S1 666.55      666.55       666.55 720.0  736.5  137    557.0  680.375</span></span>
<span><span class="co">#&gt; S2       S2 614.00      614.00       614.00 619.3  623.0  233    610.0  594.125</span></span>
<span><span class="co">#&gt; S3       S3 412.10      412.10       412.10 373.1  366.5   13    499.0  409.750</span></span>
<span><span class="co">#&gt; S4       S4 568.00      568.00       568.00 567.1  562.0   53    521.5  574.500</span></span>
<span><span class="co">#&gt; S5       S5 429.00      429.00       429.00 384.4  323.0   43    478.0  437.500</span></span>
<span><span class="co">#&gt; S6       S6 556.85      556.85       556.85 529.9  519.0   77    521.0  547.500</span></span>
<span><span class="co">#&gt;     trimean bristow reviewedBristow weightedSum      ssGSEA       gsva</span></span>
<span><span class="co">#&gt; S1 708.4375       0               0     10597.7  0.89773866  0.3540929</span></span>
<span><span class="co">#&gt; S2 608.5625       0               0     10597.7  0.87143168  0.3861167</span></span>
<span><span class="co">#&gt; S3 388.1250       0               0     10597.7 -0.06961626 -0.4555556</span></span>
<span><span class="co">#&gt; S4 568.2500       0               0     10597.7  0.71651992  0.1970318</span></span>
<span><span class="co">#&gt; S5 380.2500       0               0     10597.7  0.11853850 -0.1037908</span></span>
<span><span class="co">#&gt; S6 533.2500       0               0     10597.7  0.44551534  0.1068011</span></span>
<span><span class="co">#&gt;         plage     zscore</span></span>
<span><span class="co">#&gt; S1 -0.3210647  2.1673343</span></span>
<span><span class="co">#&gt; S2  0.2938191  1.1924762</span></span>
<span><span class="co">#&gt; S3  0.5088480 -1.9536056</span></span>
<span><span class="co">#&gt; S4 -0.1577183  0.4199618</span></span>
<span><span class="co">#&gt; S5  0.1773275 -1.2097106</span></span>
<span><span class="co">#&gt; S6 -0.3916968  0.5601269</span></span></code></pre></div>
<p>To change the default arguments of a specific score function, we can
use <code>args</code>: the argument accept a named list, where the name
of the element must match the id of the score we want to compute. For
example, we may want to compute a trimmed mean considering a specific
fraction of elements to be trimmed from each end. Looking at the
documentation of <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code> we see the internal
function computing the trimmed mean is called
<code><a href="../reference/trimmedMeanScores.html">?trimmedMeanScores</a></code>, which accepts an argument
<code>trim</code>. We can then pass the argument from
<code><a href="../reference/computeSigScores.html">?computeSigScores</a></code> via <code>args</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x      <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i      <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm  <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scores <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>  args   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trimmedMean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trim <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span>
<span><span class="co">#&gt;    sampleID   mean trimmedMean weightedMean   IQM median mode midrange midhinge</span></span>
<span><span class="co">#&gt; S1       S1 666.55    712.5833       666.55 720.0  736.5  137    557.0  680.375</span></span>
<span><span class="co">#&gt; S2       S2 614.00    615.1667       614.00 619.3  623.0  233    610.0  594.125</span></span>
<span><span class="co">#&gt; S3       S3 412.10    376.5833       412.10 373.1  366.5   13    499.0  409.750</span></span>
<span><span class="co">#&gt; S4       S4 568.00    568.0833       568.00 567.1  562.0   53    521.5  574.500</span></span>
<span><span class="co">#&gt; S5       S5 429.00    395.0000       429.00 384.4  323.0   43    478.0  437.500</span></span>
<span><span class="co">#&gt; S6       S6 556.85    543.3333       556.85 529.9  519.0   77    521.0  547.500</span></span>
<span><span class="co">#&gt;     trimean bristow reviewedBristow weightedSum      ssGSEA       gsva</span></span>
<span><span class="co">#&gt; S1 708.4375       0               0     10597.7  0.89773866  0.3540929</span></span>
<span><span class="co">#&gt; S2 608.5625       0               0     10597.7  0.87143168  0.3861167</span></span>
<span><span class="co">#&gt; S3 388.1250       0               0     10597.7 -0.06961626 -0.4555556</span></span>
<span><span class="co">#&gt; S4 568.2500       0               0     10597.7  0.71651992  0.1970318</span></span>
<span><span class="co">#&gt; S5 380.2500       0               0     10597.7  0.11853850 -0.1037908</span></span>
<span><span class="co">#&gt; S6 533.2500       0               0     10597.7  0.44551534  0.1068011</span></span>
<span><span class="co">#&gt;         plage     zscore</span></span>
<span><span class="co">#&gt; S1 -0.3210647  2.1673343</span></span>
<span><span class="co">#&gt; S2  0.2938191  1.1924762</span></span>
<span><span class="co">#&gt; S3  0.5088480 -1.9536056</span></span>
<span><span class="co">#&gt; S4 -0.1577183  0.4199618</span></span>
<span><span class="co">#&gt; S5  0.1773275 -1.2097106</span></span>
<span><span class="co">#&gt; S6 -0.3916968  0.5601269</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualisation">Visualisation<a class="anchor" aria-label="anchor" href="#visualisation"></a>
</h2>
<p><code>sigscores</code> provides some basic functions for plotting.
For example, we can plot our computed results via an heat map by using
the <code><a href="../reference/heatmapSigScores.html">?heatmapSigScores</a></code> function, which requires the output
of <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code> as the <code>data</code>
parameter.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create plot</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/heatmapSigScores.html">heatmapSigScores</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">scores</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#visualise</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="sigscores_files/figure-html/summary_scores_w_args_plot_heatmap-1.png" width="576"></p>
<p>We can visualise the correlation of the summary scores by using
another built-in function, i.e. <code><a href="../reference/heatmapCorSigScores.html">?heatmapCorSigScores</a></code>. The
correlation matrix can be directly provided via the <code>cor</code>
parameter. If <code>cor = NULL</code>, <code><a href="../reference/heatmapCorSigScores.html">?heatmapCorSigScores</a></code>
internally computes the correlation by using the default settings of
<code><a href="../reference/computeSigScoresCorrelation.html">?computeSigScoresCorrelation</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create plot</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/heatmapCorSigScores.html">heatmapCorSigScores</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">scores</span>,</span>
<span>  cor  <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in cor(x, use = use, method = method): the standard deviation is zero</span></span>
<span></span>
<span><span class="co">#visualise</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="sigscores_files/figure-html/summary_scores_correlation_plot_heatmap-1.png" width="576"></p>
<p>It is also possible to represent the summary scores via box plots
thanks to another built-in function,
i.e. <code><a href="../reference/boxplotSigScores.html">?boxplotSigScores</a></code>. We can also subset the scores we
want to plot by using the <code>scores</code> parameter.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create plot</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/boxplotSigScores.html">boxplotSigScores</a></span><span class="op">(</span></span>
<span>  data   <span class="op">=</span> <span class="va">scores</span>,</span>
<span>  scores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"mode"</span>, <span class="st">"median"</span>, <span class="st">"IQM"</span>, <span class="st">"midrange"</span>, <span class="st">"midhinge"</span>, <span class="st">"trimean"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#visualise</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="sigscores_files/figure-html/summary_scores_plot_boxplot-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="significance-of-the-scores">Significance of the Scores<a class="anchor" aria-label="anchor" href="#significance-of-the-scores"></a>
</h2>
<p>We may want to understand if the computed scores are due to the
selected genes in our signature, or if we might have ended up with
similar scores also with different lists of genes. To associate
significance to each of the computed scores we can use a resampling
method. The idea is to calculate the probability of observing a
resampling value as extreme as the one calculated on the original data.
The main steps involved in this process are:</p>
<ol style="list-style-type: decimal">
<li>Draw random samples from the original data</li>
<li>Compute the summary scores on the simulated data</li>
<li>Create a sampling distribution for each score</li>
<li>Calculate the significance for each score</li>
</ol>
<p>To facilitate this computation, <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code> can
also calculate the summary scores for data sets generated using
resampling. Two techniques are provided out-of-the-box in
<code><a href="../reference/computeSigScores.html">?computeSigScores</a></code>: <strong>permutation</strong>
(i.e. sampling without replacement) and <strong>bootstrap</strong>
(i.e. sampling with replacement). The main new arguments we need to set
are <code>sampling</code>, which indicates the technique we want to use,
and <code>n.repeat</code>, which tells the function how many random
samples we want to generate.</p>
<p>Let’s create summary scores for 10 data sets generated using sampling
without replacement.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm    <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>  sampling <span class="op">=</span> <span class="st">"permutation"</span>,</span>
<span>  n.repeat <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span>
<span><span class="co">#&gt;   run sampleID   mean trimmedMean weightedMean   IQM median mode midrange</span></span>
<span><span class="co">#&gt; 1   1       S1 363.85      363.85       363.85 305.3  261.0    2    449.0</span></span>
<span><span class="co">#&gt; 2   1       S2 496.50      496.50       496.50 489.6  507.5    3    489.0</span></span>
<span><span class="co">#&gt; 3   1       S3 437.50      437.50       437.50 357.4  384.0   81    539.0</span></span>
<span><span class="co">#&gt; 4   1       S4 456.70      456.70       456.70 432.2  399.0   51    520.5</span></span>
<span><span class="co">#&gt; 5   1       S5 371.35      371.35       371.35 336.9  319.0    8    454.0</span></span>
<span><span class="co">#&gt; 6   1       S6 570.90      570.90       570.90 574.7  571.0  149    557.0</span></span>
<span><span class="co">#&gt;   midhinge  trimean bristow reviewedBristow weightedSum      ssGSEA       gsva</span></span>
<span><span class="co">#&gt; 1  357.750 309.3750       0               0      9419.4 -0.49970900 -0.3371350</span></span>
<span><span class="co">#&gt; 2  489.250 498.3750       0               0      9419.4  0.19929221  0.1311368</span></span>
<span><span class="co">#&gt; 3  372.500 378.2500       0               0      9419.4  0.01770463  0.1157828</span></span>
<span><span class="co">#&gt; 4  479.875 439.4375       0               0      9419.4  0.11019309  0.1502551</span></span>
<span><span class="co">#&gt; 5  379.750 349.3750       0               0      9419.4 -0.21291592 -0.1771978</span></span>
<span><span class="co">#&gt; 6  552.125 561.5625       0               0      9419.4  0.49461406  0.4529517</span></span>
<span><span class="co">#&gt;          plage     zscore</span></span>
<span><span class="co">#&gt; 1 -0.430876879 -1.3739329</span></span>
<span><span class="co">#&gt; 2 -0.002122875  0.3751179</span></span>
<span><span class="co">#&gt; 3 -0.385513783 -0.8065714</span></span>
<span><span class="co">#&gt; 4 -0.088276998 -0.1428458</span></span>
<span><span class="co">#&gt; 5 -0.209271662 -1.3765625</span></span>
<span><span class="co">#&gt; 6  0.453742266  1.6396185</span></span></code></pre></div>
<p>To use bootstrap instead, we just need change the
<code>sampling</code> argument.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm    <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>  sampling <span class="op">=</span> <span class="st">"bootstrap"</span>,</span>
<span>  n.repeat <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">scores</span>, n <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="co">#&gt;   run sampleID   mean trimmedMean weightedMean   IQM median mode midrange</span></span>
<span><span class="co">#&gt; 1   1       S1 531.40      531.40       531.40 601.4  692.0  692    440.5</span></span>
<span><span class="co">#&gt; 2   1       S2 458.15      458.15       458.15 416.0  361.5   32    503.5</span></span>
<span><span class="co">#&gt; 3   1       S3 533.25      533.25       533.25 545.3  584.5  563    539.0</span></span>
<span><span class="co">#&gt; 4   1       S4 366.25      366.25       366.25 383.7  409.5   22    420.0</span></span>
<span><span class="co">#&gt; 5   1       S5 432.85      432.85       432.85 439.1  400.5    6    472.0</span></span>
<span><span class="co">#&gt; 6   1       S6 550.45      550.45       550.45 559.7  566.0  566    560.5</span></span>
<span><span class="co">#&gt;   midhinge  trimean bristow reviewedBristow weightedSum     ssGSEA        gsva</span></span>
<span><span class="co">#&gt; 1  510.500 601.2500       0               0      9484.0  0.2382717  0.10920578</span></span>
<span><span class="co">#&gt; 2  478.125 419.8125       0               0      9551.3  0.2153395  0.07273132</span></span>
<span><span class="co">#&gt; 3  510.375 547.4375       0               0      9536.6  0.3853388  0.10535714</span></span>
<span><span class="co">#&gt; 4  339.500 374.5000       0               0      9592.1 -0.2816480 -0.19861111</span></span>
<span><span class="co">#&gt; 5  437.625 419.0625       0               0      9549.3  0.1844530 -0.16397300</span></span>
<span><span class="co">#&gt; 6  564.500 565.2500       0               0      9499.2  0.4535682  0.17213115</span></span>
<span><span class="co">#&gt;         plage     zscore</span></span>
<span><span class="co">#&gt; 1 -0.15801753  0.8728117</span></span>
<span><span class="co">#&gt; 2  0.42059271 -0.5968935</span></span>
<span><span class="co">#&gt; 3 -0.26930515  0.4721479</span></span>
<span><span class="co">#&gt; 4  0.05836157 -1.3292259</span></span>
<span><span class="co">#&gt; 5 -0.53494029 -0.4985339</span></span>
<span><span class="co">#&gt; 6  0.00608184  0.7195745</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parallel-execution">Parallel Execution<a class="anchor" aria-label="anchor" href="#parallel-execution"></a>
</h2>
<p><strong>sigscores</strong> provides a simple approach to speed up
computation on a multi-core computer via the usage of <a href="https://stat.ethz.ch/R-manual/R-devel/library/parallel/html/00Index.html" class="external-link">parallel</a>,
<a href="https://cran.r-project.org/package=doParallel" class="external-link">doParallel</a>,
and <a href="https://cran.r-project.org/package=foreach" class="external-link">foreach</a> R
packages.</p>
<p>To enable parallel execution we just need to set the argument
<code>cores</code> in the <code><a href="../reference/computeSigScores.html">?computeSigScores</a></code> function with
an integer greater than 1. For example, let’s try to use 2 cores.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores with parallel execution</span></span>
<span><span class="va">scores</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>  x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>  i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>  na.rm    <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>  sampling <span class="op">=</span> <span class="st">"permutation"</span>,</span>
<span>  n.repeat <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  cores    <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>As a note, the function internally perform some checks before setting
a parallel environment, so if the provided number of cores is too high
it will set <code>cores</code> as the maximum number of available
(logical) processors on the machine minus 1.</p>
<div class="section level3">
<h3 id="serial-vs-parallel">Serial vs Parallel<a class="anchor" aria-label="anchor" href="#serial-vs-parallel"></a>
</h3>
<p>We could see the advantage of using a parallel execution by comparing
the computation time between a serial and parallel setting when having
an higher number of repeats. To time the execution of the function calls
we can use the <code><a href="https://rdrr.io/r/base/system.time.html" class="external-link">?system.time</a></code> R function.</p>
<p>Let’s consider 500 permutations of the original data and compute the
scores in a serial fashion first.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">time_serial</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  expr <span class="op">=</span> <span class="op">{</span></span>
<span>    <span class="va">scoresS</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>      x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>      i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>      na.rm    <span class="op">=</span> <span class="cn">T</span>,</span>
<span>      scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>      sampling <span class="op">=</span> <span class="st">"permutation"</span>,</span>
<span>      n.repeat <span class="op">=</span> <span class="fl">500</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we can run the parallel execution with the same number of repeats
and selecting 5 cores. Considering that we don’t need the results of the
parallel execution to be in order, we can set the argument
<code>.inorder</code> as <code>FALSE</code> since this can improve the
performance.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute summary scores</span></span>
<span><span class="va">time_parallel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  expr <span class="op">=</span> <span class="op">{</span></span>
<span>    <span class="va">scoresP</span> <span class="op">=</span> <span class="fu">sigscores</span><span class="fu">::</span><span class="fu"><a href="../reference/computeSigScores.html">computeSigScores</a></span><span class="op">(</span></span>
<span>      x        <span class="op">=</span> <span class="va">x</span>,</span>
<span>      i        <span class="op">=</span> <span class="va">signature</span>,</span>
<span>      na.rm    <span class="op">=</span> <span class="cn">T</span>,</span>
<span>      scores   <span class="op">=</span> <span class="va">summary.scores.ids</span>,</span>
<span>      sampling <span class="op">=</span> <span class="st">"permutation"</span>,</span>
<span>      n.repeat <span class="op">=</span> <span class="fl">500</span>,</span>
<span>      cores    <span class="op">=</span> <span class="fl">5</span>,</span>
<span>      .inorder <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can compare the execution time. On a laptop having the
following hardware:</p>
<ul>
<li>Intel(R) Core(TM) i7-8650 CPU @ 1.90GHz, 2112MHz, 4 Core(s), 8
Logical Processor(s)</li>
<li>1TB SSD Hard Drive</li>
<li>16GB RAM</li>
</ul>
<p>the execution times for the serial and parallel computations
were:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create a matrix</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  serial   <span class="op">=</span> <span class="va">time_serial</span>,</span>
<span>  parallel <span class="op">=</span> <span class="va">time_parallel</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt;          user.self sys.self elapsed user.child sys.child</span></span>
<span><span class="co">#&gt; serial      176.97     0.30  180.19         NA        NA</span></span>
<span><span class="co">#&gt; parallel      1.41     2.47   82.31         NA        NA</span></span></code></pre></div>
<p>The parallel execution was around 2.19 times faster than the serial
execution.</p>
<!-- ## Session Info -->
<!-- The version number of R and packages loaded for generating the vignette. -->
<!-- ```{r session_info} -->
<!-- sessionInfo() -->
<!-- ``` -->
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alessandro Barberis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
